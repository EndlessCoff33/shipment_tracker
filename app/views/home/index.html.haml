- title 'Feature Reviewed Tickets'
%form.form-inline{"accept-charset" => "UTF-8", :action => "/", :method => "get"}
  %input{:name => "preview", :type => "hidden", :value => "true"}/
  .form-group
    %label.control-label.sr-only{:for => "q"} Search for deployed tickets:
    %input#q.form-control{:name => "q", :placeholder => "keywords in ticket description", :style => "width:700px;", :type => "text", :value => @query}/
    #datepicker.input-daterange.input-group
      %span.input-group-addon from
      %input#from_date.input-sm.form-control{:name => "from", :type => "text", :style => "width: 120px; height: 34px;", :value => @from_date}/
      %span.input-group-addon to
      %input#to_date.input-sm.form-control{:name => "to", :type => "text", :style => "width: 120px; height: 34px;", :value => @to_date}/
  %input.btn.btn-primary{:type => "submit", :value => "Search"}/

- if @query
  - if @tickets.any?
    %h2= "Results for '#{@query}'"
  -else
    %h2= "No results for '#{@query}' :/"
  - @tickets.in_groups_of(3) do | tickets_row |
    .row
      - tickets_row.compact.each do | ticket |
        .col-md-4
          .panel.panel-default.result
            .panel-heading
              %span.key= jira_link(ticket.key)
              %strong.summary= truncate(ticket.summary, length: 100, seperator: ' ')
            .panel-body
              - if ticket.description.nil?
                %em.description No description found.
              - else
                = simple_format(truncate(ticket.description, length: 250, seperator: ' '), class: 'description')
              %p
                %hr
                %b Deploys
              - if ticket.deploys.empty?
                %p none
              - ticket.deploys.each do |deploy|
                %p.deploy
                  = flag_icon(deploy['region'].to_sym)
                  = "#{deploy['deployed_at']} #{deploy['app']}"
                  = commit_link(deploy['version'], deploy['github_url'])
